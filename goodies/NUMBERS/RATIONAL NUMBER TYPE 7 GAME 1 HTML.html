<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>LCM and HCF of 3 Numbers – Exam Practice</title>

<style>
  body {
    margin: 0;
    padding: 24px;
    font-family: "Segoe UI", Roboto, Arial, sans-serif;
    background: #f8f9fa;
    color: #111;
  }
  .card {
    max-width: 900px;
    margin: auto;
    padding: 30px;
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  }
  .q {
    font-size: 19px;
    font-weight: 700;
    margin-bottom: 20px;
    color: #0056b3;
    line-height: 1.4;
  }
  .line {
    font-size: 16px;
    margin: 8px 0;
    white-space: pre-wrap;
    font-family: "Courier New", Courier, monospace;
  }
  .math-block {
    background: #f1f3f5;
    padding: 15px;
    border-radius: 8px;
    margin: 15px 0;
    font-family: "Times New Roman", serif;
  }
  .hint {
    font-size: 14px;
    font-style: italic;
    color: #666;
    margin-top: 20px;
    border-top: 1px solid #eee;
    padding-top: 10px;
  }
  b { color: #d63384; }
  .factor-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 10px;
  }
  .factor-col {
    flex: 1;
    min-width: 200px;
    border: 1px solid #ddd;
    padding: 10px;
    border-radius: 8px;
    background: #fff;
  }
</style>
</head>

<body>
<main class="card" role="main" aria-live="polite" id="card">
  <div id="content"></div>
  <div class="hint" id="hint">Press any key to see the solution.</div>
</main>

<script>
(function(){
  "use strict";

  const PRIMES = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29];

  let stage = "question";
  const content = document.getElementById("content");
  const hint = document.getElementById("hint");

  // Helper to ensure HCF > 1
  function generateTrio() {
    const commonBases = [2, 3, 4, 5, 6, 10];
    const base = commonBases[Math.floor(Math.random() * commonBases.length)];
    
    // Generate multipliers that are somewhat diverse
    let m1 = Math.floor(Math.random() * 8) + 1;
    let m2 = Math.floor(Math.random() * 8) + 2;
    let m3 = Math.floor(Math.random() * 12) + 3;
    
    return [base * m1, base * m2, base * m3];
  }

  function factorize(n) {
    let temp = n;
    let steps = [];
    let factors = [];
    
    for (const p of PRIMES) {
      while (temp % p === 0) {
        steps.push(`${p.toString().padStart(2, ' ')} | ${temp}`);
        factors.push(p);
        temp /= p;
      }
    }
    
    if (temp > 1) {
      steps.push(`${temp.toString().padStart(2, ' ')} | ${temp}`);
      factors.push(temp);
      temp = 1;
    }
    
    steps.push("   | 1");
    return { steps, factors };
  }

  function getPowerMap(factors) {
    const map = {};
    factors.forEach(f => map[f] = (map[f] || 0) + 1);
    return map;
  }

  function expForm(factors) {
    const map = getPowerMap(factors);
    return Object.keys(map)
      .map(p => map[p] > 1 ? `${p}<sup>${map[p]}</sup>` : `${p}`)
      .join(" × ");
  }

  function ask() {
    stage = "question";
    content.innerHTML = "";
    hint.textContent = "Press any key to see the solution.";

    const trio = generateTrio();
    const [a, b, c] = trio;

    content.dataset.state = JSON.stringify({ a, b, c });

    content.innerHTML =
      `<div class="q">
        Q. Find the HCF and LCM of the following integers by applying the prime factorization method.<br><br>
        Numbers: <b>${a}, ${b}, and ${c}</b>
      </div>`;
  }

  function reveal() {
    stage = "answer";
    const { a, b, c } = JSON.parse(content.dataset.state);
    const fa = factorize(a);
    const fb = factorize(b);
    const fc = factorize(c);

    const mapA = getPowerMap(fa.factors);
    const mapB = getPowerMap(fb.factors);
    const mapC = getPowerMap(fc.factors);
    
    const allPrimes = [...new Set([...fa.factors, ...fb.factors, ...fc.factors])].sort((x, y) => x - y);

    let hcfVal = 1;
    let hcfParts = [];
    let lcmVal = 1;
    let lcmParts = [];

    allPrimes.forEach(p => {
      const pA = mapA[p] || 0;
      const pB = mapB[p] || 0;
      const pC = mapC[p] || 0;

      // HCF: Smallest power of COMMON factors (must be in all three)
      if (pA > 0 && pB > 0 && pC > 0) {
        const minP = Math.min(pA, pB, pC);
        hcfVal *= Math.pow(p, minP);
        hcfParts.push(minP > 1 ? `${p}<sup>${minP}</sup>` : `${p}`);
      }

      // LCM: Greatest power of all factors present in any number
      const maxP = Math.max(pA, pB, pC);
      lcmVal *= Math.pow(p, maxP);
      lcmParts.push(maxP > 1 ? `${p}<sup>${maxP}</sup>` : `${p}`);
    });

    const hcfExp = hcfParts.length ? hcfParts.join(" × ") : "1 (No common prime factors)";
    const lcmExp = lcmParts.join(" × ");

    content.innerHTML += `
      <div class="math-block">
        <b>Step 1: Prime Factorization</b><br><br>
        <div class="factor-grid">
          <div class="factor-col">
            Factorization of ${a}:<br>
            <div class="line">${fa.steps.join("\n")}</div>
            ${a} = ${expForm(fa.factors)}
          </div>
          <div class="factor-col">
            Factorization of ${b}:<br>
            <div class="line">${fb.steps.join("\n")}</div>
            ${b} = ${expForm(fb.factors)}
          </div>
          <div class="factor-col">
            Factorization of ${c}:<br>
            <div class="line">${fc.steps.join("\n")}</div>
            ${c} = ${expForm(fc.factors)}
          </div>
        </div>
      </div>

      <div class="math-block">
        <b>Step 2: Calculate HCF</b><br>
        HCF is the product of the smallest power of each common prime factor.<br>
        HCF (${a}, ${b}, ${c}) = ${hcfExp} = <b>${hcfVal}</b>
      </div>

      <div class="math-block">
        <b>Step 3: Calculate LCM</b><br>
        LCM is the product of the greatest power of each prime factor involved.<br>
        LCM (${a}, ${b}, ${c}) = ${lcmExp} = <b>${lcmVal}</b>
      </div>
    `;

    hint.textContent = "Press 'Y' for next question or 'N' to exit.";
  }

  ask();

  window.addEventListener("keydown", function(e) {
    const k = (e.key || "").toLowerCase();
    if (stage === "question") {
      reveal();
    } else {
      if (k === "y") ask();
      if (k === "n") {
        document.getElementById("card").innerHTML = "<div class='q'>Session ended. Keep practicing!</div>";
      }
    }
  });

})();
</script>
</body>
</html>