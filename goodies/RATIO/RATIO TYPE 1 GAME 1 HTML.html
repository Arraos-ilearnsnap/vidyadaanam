<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ratio Transformation Game</title>
<style>
  :root{--bg:#fff;--card:#fff;--muted:#666;--accent:#0b59c6}
  html,body{height:100%;margin:0;background:var(--bg);font-family:Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#111}
  .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:20px}
  .card{width:100%;max-width:1020px;background:var(--card);border-radius:10px;padding:22px 20px;box-shadow:0 8px 28px rgba(16,49,90,0.06)}
  h1{font-size:16px;margin:0 0 10px;font-weight:700}
  .question{font-size:20px;color:var(--accent);margin:12px 0;font-weight:700}
  .prompt{color:var(--muted);font-size:13px;margin-bottom:10px;font-style:italic}
  .steps{white-space:pre-line;font-size:17px;line-height:1.45;color:#111;margin-top:12px}
  .foot{margin-top:10px;color:var(--muted);font-size:13px}
  .hidden{display:none}
  .goodbye{padding:48px;text-align:center;font-size:20px;color:#333}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="card" role="main" aria-live="polite">
    <h1>Ratio Expression Evaluation</h1>
    <div class="question" id="qText">—</div>
    <div class="prompt" id="prompt">Press any key to reveal all steps…</div>
    <div id="stepsBox" class="steps hidden"></div>
    <div class="foot">After reveal press <strong>y</strong> for next or <strong>n</strong> to exit.</div>
  </div>
</div>

<script>
(function(){
  // random integer 1–9
  function r(){ return Math.floor(Math.random()*9)+1; }

  // gcd
  function gcd(x,y){
    while(y!==0){ var t=x%y; x=y; y=t; }
    return Math.abs(x);
  }

  // question variants (first set: 3, second set: 2)
  var variants = [
    // FIRST SET
    "If x : y = A : B, find the ratio (P x + Q y) : (R x + S y).",
    "Given that x : y = A : B, determine the value of the ratio (P x + Q y) to (R x + S y).",
    "Based on the ratio x : y = A : B, compute the ratio (P x + Q y) and (R x + S y).",
    // SECOND SET
    "If the numbers x and y stand in the ratio A : B, what will be the ratio of the expressions (P x + Q y) and (R x + S y)?",
    "Using the fact that x : y = A : B, evaluate the ratio formed by (P x + Q y) to (R x + S y)."
  ];

  var stage="question";
  var A,B,P,Q,R,S;
  var qEl=document.getElementById("qText");
  var prompt=document.getElementById("prompt");
  var stepsBox=document.getElementById("stepsBox");

  function makeQuestion(){
    stage="question";
    stepsBox.classList.add("hidden");
    stepsBox.textContent="";
    prompt.textContent="Press any key to reveal all steps…";

    A=r(); B=r();
    P=r(); Q=r(); R=r(); S=r();

    var v = variants[Math.floor(Math.random()*variants.length)];
    var q = v.replace("A",A).replace("B",B)
             .replace("P",P).replace("Q",Q)
             .replace("R",R).replace("S",S);

    qEl.textContent = q;
  }

  function reveal(){
    stage="answer";
    prompt.textContent='Press "y" for next or "n" to exit.';
    stepsBox.classList.remove("hidden");

    // Calculations
    var pa = P*A;
    var qb = Q*B;
    var ra = R*A;
    var sb = S*B;

    var num = pa + qb;
    var den = ra + sb;

    var g = gcd(num, den);
    var simpNum = num/g;
    var simpDen = den/g;

    // EXACT STEP FORMAT — MATCHING YOUR WORK
    var t = "";
    t += "Step 1 — Let the two numbers be:\n";
    t += "x = " + A + "k,   y = " + B + "k\n\n";

    t += "Step 2 — Substitute into the ratio:\n";
    t += "(" + P + "x + " + Q + "y) / (" + R + "x + " + S + "y)\n";
    t += "⇒ " + P + "(" + A + "k) + " + Q + "(" + B + "k)\n";
    t += "   " + R + "(" + A + "k) + " + S + "(" + B + "k)\n\n";

    t += "Step 3 — Compute each part:\n";
    t += P + "(" + A + "k) = " + pa + "k\n";
    t += Q + "(" + B + "k) = " + qb + "k\n";
    t += R + "(" + A + "k) = " + ra + "k\n";
    t += S + "(" + B + "k) = " + sb + "k\n\n";

    t += "Step 4 — Add like terms:\n";
    t += "Numerator: " + pa + "k + " + qb + "k = " + num + "k\n";
    t += "Denominator: " + ra + "k + " + sb + "k = " + den + "k\n\n";

    t += "Step 5 — Cancel the common factor k:\n";
    t += num + "k / " + den + "k = " + num + " / " + den + "\n\n";

    t += "Step 6 — Simplify the fraction if possible:\n";
    if(g > 1){
      t += num + "/" + den + " = " + simpNum + "/" + simpDen + "\n\n";
    } else {
      t += "Already in simplest form.\n\n";
    }

    t += "Step 7 — Final ratio:\n";
    t += simpNum + " : " + simpDen;

    stepsBox.textContent = t;
  }

  makeQuestion();

  window.addEventListener("keydown",function(e){
    var k=(e.key||"").toLowerCase();
    if(stage==="question"){
      reveal();
    } else if(stage==="answer"){
      if(k==="y"){
        makeQuestion();
      } else if(k==="n"){
        document.getElementById("card").innerHTML =
          '<div class="goodbye">Goodbye — thanks!<div style="font-size:13px;color:#666;margin-top:8px">You may now close this tab.</div></div>';
      }
    }
  });

  document.addEventListener("selectstart",function(e){ e.preventDefault(); });
})();
</script>
</body>
</html>
