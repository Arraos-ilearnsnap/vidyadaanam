<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ratio in Simplest Form – Step by Step</title>

<style>
body{
  margin:0;
  padding:24px;
  font-family:"Segoe UI", Roboto, Arial, sans-serif;
  background:#f4f6f8;
  display:flex;
  justify-content:center;
}
.card{
  max-width:900px;
  width:100%;
  background:#ffffff;
  padding:28px;
  border-radius:12px;
  box-shadow:0 8px 26px rgba(0,0,0,0.08);
}
.q{
  font-size:22px;
  font-weight:700;
  margin-bottom:20px;
}
.line{
  font-size:18px;
  margin:8px 0;
}
.step{
  font-size:18px;
  margin:10px 0;
}
.frac{
  display:inline-flex;
  flex-direction:column;
  align-items:center;
  margin:0 6px;
}
.frac .num{
  border-bottom:2px solid #000;
  padding:0 6px;
}
.frac .den{
  padding:0 6px;
}
.box{
  display:inline-block;
  padding:10px 18px;
  border:2px solid #111;
  font-weight:700;
  background:#f9f9f9;
  margin-top:16px;
}
.prompt{
  margin-top:24px;
  font-size:14px;
  font-style:italic;
  color:#555;
  text-align:center;
}
</style>
</head>

<body>
<main class="card" id="card">
  <div id="content"></div>
  <div class="prompt" id="prompt">
    Press any key to reveal the solution. After reveal press <b>y</b> for next or <b>n</b> to exit.
  </div>
</main>

<script>
(function(){
"use strict";

/* -------- PRIME SET (STRICTLY LIMITED) -------- */
const primes = [2,3,5,7,11,13,17,19,23,29];

const content = document.getElementById("content");
const prompt  = document.getElementById("prompt");

let stage = "q";
let A, B, decimalPlaces;

/* ---------- HELPERS ---------- */

function gcd(a,b){ return b ? gcd(b,a%b) : a; }

function randomFrom(arr){
  return arr[Math.floor(Math.random()*arr.length)];
}

function fracHTML(n,d){
  return `<span class="frac"><span class="num">${n}</span><span class="den">${d}</span></span>`;
}

/* ---------- NUMBER GENERATION ---------- */

function generatePair(){
  // choose decimal places 1–3
  decimalPlaces = Math.floor(Math.random()*3) + 1;
  const scale = Math.pow(10, decimalPlaces);

  // base integer (ignoring decimal)
  let base = randomFrom(primes);
  while(base < 100) base *= randomFrom(primes);
  while(base > 2000) base = Math.floor(base / randomFrom(primes));

  // denominator
  B = randomFrom(primes);
  while(B < 100) B *= randomFrom(primes);
  while(B > 2000) B = Math.floor(B / randomFrom(primes));

  // ensure HCF > 1
  const common = randomFrom(primes);
  base *= common;
  B *= common;

  // final numerator with decimal
  A = (base / scale).toFixed(decimalPlaces);

  // safety
  if(gcd(base, B) === 1) return generatePair();
}

/* ---------- QUESTION ---------- */

function showQ(){
  generatePair();
  content.innerHTML = `
    <div class="q">Express the ratio in the simplest form:</div>
    <div class="q">${A} to ${B}</div>
  `;
  stage = "q";
}

/* ---------- SOLUTION ---------- */

function showA(){
  let html = `<div class="line"><b>Writing as fraction and simplifying:</b></div>`;

  let n = Number(A);
  let d = B;

  html += `<div class="step">⇒ ${fracHTML(n, d)}</div>`;

  // Decimal removal step
  const multiplier = Math.pow(10, decimalPlaces);
  html += `
    <div class="step">
      ⇒ ${fracHTML(`${n} × ${multiplier}`, `${d} × ${multiplier}`)}
    </div>
  `;

  n = Math.round(n * multiplier);
  d = d * multiplier;

  html += `<div class="step">⇒ ${fracHTML(n, d)}</div>`;

  // Prime simplification
  for(const p of primes){
    while(n % p === 0 && d % p === 0){
      html += `
        <div class="step">
          ⇒ ${fracHTML(`${n} ÷ ${p}`, `${d} ÷ ${p}`)}
        </div>
      `;
      n /= p;
      d /= p;
      html += `<div class="step">⇒ ${fracHTML(n, d)}</div>`;
    }
  }

  html += `
    <div class="line">
      <span class="box">
        So, the simplest form of the ratio ${A} to ${B} is ${n} to ${d}.
      </span>
    </div>
  `;

  content.innerHTML += html;
  prompt.textContent = "Press y for next question or n to exit.";
  stage = "a";
}

/* ---------- FLOW ---------- */

showQ();

window.addEventListener("keydown", e=>{
  const k = (e.key||"").toLowerCase();
  if(stage === "q") showA();
  else if(k === "y"){
    showQ();
    prompt.textContent = "Press any key to reveal the solution.";
  }
  else if(k === "n"){
    document.getElementById("card").innerHTML = "<div class='q'>Session ended.</div>";
  }
});
})();
</script>
</body>
</html>
