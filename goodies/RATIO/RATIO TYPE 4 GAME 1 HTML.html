<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Find Added Number for Ratio Transformation</title>
<style>
  :root{--bg:#fff;--card:#fff;--muted:#666;--accent:#0b59c6}
  html,body{
    height:100%;margin:0;background:var(--bg);
    font-family:Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#111;
  }
  .wrap{
    min-height:100%;display:flex;align-items:center;
    justify-content:center;padding:20px;
  }
  .card{
    width:100%;max-width:1020px;background:var(--card);
    border-radius:10px;padding:22px 20px;
    box-shadow:0 8px 28px rgba(16,49,90,0.06);
  }
  h1{font-size:16px;margin:0 0 10px;font-weight:700}
  .question{font-size:20px;color:var(--accent);margin:12px 0;font-weight:700}
  .prompt{color:var(--muted);font-size:13px;margin-bottom:10px;font-style:italic}
  .steps{white-space:pre-line;font-size:17px;line-height:1.45;color:#111;margin-top:12px}
  .foot{margin-top:10px;color:var(--muted);font-size:13px}
  .hidden{display:none}
  .goodbye{padding:48px;text-align:center;font-size:20px;color:#333}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="card" role="main" aria-live="polite">
    <h1>Find the Added Number (Ratio Transformation)</h1>
    <div class="question" id="qText">—</div>
    <div class="prompt" id="prompt">Press any key to reveal all steps…</div>
    <div id="stepsBox" class="steps hidden"></div>
    <div class="foot">After reveal press <strong>y</strong> for next or <strong>n</strong> to exit.</div>
  </div>
</div>

<script>
(function(){

  function r(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

  // Selected Variants: 1,2,3,4,5,8,10
  const variants = [
    "What number must be added to each term of the ratio {A}:{B} so that it becomes {P}:{Q}?",
    "Given the ratio {A}:{B}, by adding what number to both terms will the ratio change to {P}:{Q}?",
    "Based on the ratio {A}:{B}, determine the number that must be added to both terms to obtain the ratio {P}:{Q}.",
    "To make the ratio {A}:{B} become {P}:{Q}, what number should be added to each term?",
    "Find the number which, when added to both terms of the ratio {A}:{B}, transforms it into the ratio {P}:{Q}.",
    "Adding the same quantity to both terms of {A}:{B} results in {P}:{Q}. What quantity is added?",
    "How much must be added to both numbers in the ratio {A}:{B} to make the new ratio {P}:{Q}?"
  ];

  let A,B,P,Q,aVal;
  let stage="question";
  const qEl=document.getElementById("qText");
  const prompt=document.getElementById("prompt");
  const stepsBox=document.getElementById("stepsBox");

  function makeQuestion(){
    stage="question";
    stepsBox.classList.add("hidden");
    stepsBox.textContent="";
    prompt.textContent="Press any key to reveal all steps…";

    while(true){
      // Original ratio A:B
      A=r(1,15);
      B=r(1,15);
      if(A===B) continue;
      if(A===1 && B===1) continue;

      // New ratio P:Q
      P=r(1,12);
      Q=r(1,12);
      if(P===Q) continue;

      // Solve for a:
      // From: (A+a)/(B+a) = P/Q
      // Cross-multiply:
      // Q(A+a) = P(B+a)
      // Expand:
      // QA + Qa = PB + Pa
      // Rearrange:
      // (Q - P)a = PB - QA
      const leftCoef = (Q - P);
      const rightConst = (P*B - Q*A);

      if(leftCoef === 0) continue;

      const a = rightConst / leftCoef;

      // a must be positive integer
      if(Number.isInteger(a) && a > 0 && a <= 50){
        aVal = a;
        break;
      }
    }

    const v = variants[r(0,variants.length-1)];
    const q = v.replace(/\{A\}/g,A)
               .replace(/\{B\}/g,B)
               .replace(/\{P\}/g,P)
               .replace(/\{Q\}/g,Q);

    qEl.textContent = q;
  }

  function reveal(){
    stage="answer";
    prompt.textContent='Press "y" for next or "n" to exit.';
    stepsBox.classList.remove("hidden");

    const a = aVal;

    const QA = Q*A;
    const PB = P*B;
    const leftCoef = (Q - P);
    const rightConst = (P*B - Q*A);

    let t="";

    t += "Step 1 — Let 'a' be the number added to both terms:\n";
    t += "New ratio = (" + A + " + a) / (" + B + " + a)\n\n";

    t += "Step 2 — Apply the condition:\n";
    t += "(" + A + " + a) / (" + B + " + a) = " + P + " / " + Q + "\n\n";

    t += "Step 3 — Cross multiply:\n";
    t += Q + "(" + A + " + a) = " + P + "(" + B + " + a)\n\n";

    t += "Step 4 — Expand both sides:\n";
    t += Q + A + " + " + Q + "a = " + P + B + " + " + P + "a\n\n";

    t += "Step 5 — Rearrange to isolate a:\n";
    t += "(" + Q + "a - " + P + "a) = (" + P + B + " - " + Q + A + ")\n";
    t += "(" + leftCoef + ")a = " + rightConst + "\n\n";

    t += "Step 6 — Solve for a:\n";
    t += leftCoef + "a = " + rightConst + "\n";
    t += "a = (" + rightConst + ") / (" + leftCoef + ")\n";
    t += "a = " + a + "\n\n";

    t += "Step 7 — Verification:\n";
    t += "( " + A + " + " + a + " ) / ( " + B + " + " + a + " ) = ";
    const num = A + a;
    const den = B + a;
    t += num + "/" + den + "\n";

    const g = gcd(num,den);
    const sn = num/g;
    const sd = den/g;
    t += "Simplify: " + num + "/" + den + " = " + sn + "/" + sd + "\n";
    t += "Since " + sn + "/" + sd + " = " + P + "/" + Q + ", Verified.\n\n";

    t += "Final Answer:\n";
    t += "The required number to be added is " + a + ".";

    stepsBox.textContent = t;
  }

  function gcd(a,b){
    while(b!==0){ let t=a%b; a=b; b=t; }
    return Math.abs(a);
  }

  makeQuestion();

  window.addEventListener("keydown", e=>{
    const k=(e.key||"").toLowerCase();
    if(stage==="question"){ reveal(); }
    else if(stage==="answer"){
      if(k==="y"){ makeQuestion(); }
      else if(k==="n"){
        document.getElementById("card").innerHTML =
          '<div class="goodbye">Goodbye — thanks for learning!<div style="font-size:13px;color:#666;margin-top:8px">You may now close this tab.</div></div>';
      }
    }
  });

  document.addEventListener("selectstart", e=>e.preventDefault());

})();
</script>
</body>
</html>
